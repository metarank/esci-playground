# Autogenerated config file for Metarank, source=/home/shutty/work/metarank/esci/ltr/events.jsonl.zst
#
# This config file may need to be edited manually:
# - persistence config is not defined. Metarank will run in an in-memory mode by default.
# - generated feature definitions for categories may include too many/few items.
# - model training hyperparameters may not be perfect for your dataset, so you may need to tune them.
#
# train:
#   type: file
#   path: /tmp/cts.json
#   format: binary 

features:
  # - type: random
  #   name: random

  # - type: field_match
  #   name: query_title_minilm6
  #   itemField: item.title
  #   rankingField: ranking.query
  #   method:
  #     type: bi-encoder
  #     itemFieldCache: /home/shutty/work/metarank/esci/embeddings/esci-minilm-l6-v2-cos-exp/items.csv
  #     rankingFieldCache: /home/shutty/work/metarank/esci/embeddings/esci-minilm-l6-v2-cos-exp/queries.csv
  #     dim: 384

  # - type: field_match
  #   name: query_title_mpnet
  #   itemField: item.title
  #   rankingField: ranking.query
  #   method:
  #     type: bi-encoder
  #     itemFieldCache: /home/shutty/work/metarank/esci/embeddings/esci-mpnet-base-v2/items.csv
  #     rankingFieldCache: /home/shutty/work/metarank/esci/embeddings/esci-mpnet-base-v2/queries.csv
  #     dim: 768

  # - type: field_match
  #   name: query_title_ce
  #   itemField: item.title
  #   rankingField: ranking.query
  #   method:
  #     type: cross-encoder
  #     cache: /home/shutty/work/metarank/esci/embeddings/ce-esci-minilm-l12-v2/ce.csv

  - type: field_match
    name: query_title_bm25
    itemField: item.title
    rankingField: ranking.query
    method:
      type: bm25
      language: english
      termFreq: /home/shutty/work/metarank/esci/ltr/tf.json

  - type: field_match
    name: query_desc_bm25
    itemField: item.desc
    rankingField: ranking.query
    method:
      type: bm25
      language: english
      termFreq: /home/shutty/work/metarank/esci/ltr/tf.json

  - type: field_match
    name: query_bullets_bm25
    itemField: item.bullets
    rankingField: ranking.query
    method:
      type: bm25
      language: english
      termFreq: /home/shutty/work/metarank/esci/ltr/tf.json


  # - type: string
  #   name: category0
  #   field: item.category0
  #   scope: item
  #   encode: index
  #   values:
  #   - Arts, Crafts & Sewing
  #   - Automotive
  #   - Beauty & Personal Care
  #   - Books
  #   - Clothing, Shoes & Jewelry
  #   - Electronics
  #   - Grocery & Gourmet Food
  #   - Health & Household
  #   - Home & Kitchen
  #   - Office Products
  #   - Patio, Lawn & Garden
  #   - Sports & Outdoors
  #   - Tools & Home Improvement
  #   - Toys & Games
  # - type: string
  #   name: category1
  #   field: item.category1
  #   scope: item
  #   encode: index
  #   values:
  #   - Accessories
  #   - Arts & Crafts
  #   - Baby
  #   - Bath
  #   - Beading & Jewelry Making
  #   - Bedding
  #   - Beverages
  #   - Boys
  #   - Building Supplies
  #   - Camera & Photo
  #   - Cases, Holsters & Sleeves
  #   - Cats
  #   - Children's Books
  #   - Computers & Accessories
  #   - Costumes & Accessories
  #   - Crafting
  #   - Diet & Sports Nutrition
  #   - Dogs
  #   - Electrical
  #   - Event & Party Supplies
  #   - Exercise & Fitness
  #   - Exterior Accessories
  #   - Fan Shop
  #   - Feeding
  #   - Foot, Hand & Nail Care
  #   - Furniture
  #   - Games & Accessories
  #   - Gardening & Lawn Care
  #   - Girls
  #   - Hair Care
  #   - Hardware
  #   - Headphones, Earbuds & Accessories
  #   - Health Care
  #   - Heating, Cooling & Air Quality
  #   - Home Décor Products
  #   - Household Supplies
  #   - Hunting & Fishing
  #   - Interior Accessories
  #   - Kindle eBooks
  #   - Kitchen & Bath Fixtures
  #   - Kitchen & Dining
  #   - Lighting & Ceiling Fans
  #   - Literature & Fiction
  #   - Luggage & Travel Gear
  #   - Makeup
  #   - Medical Supplies & Equipment
  #   - Men
  #   - Motorcycle & Powersports
  #   - Novelty & More
  #   - Nursery
  #   - Office & School Supplies
  #   - Office Electronics
  #   - Outdoor Décor
  #   - Outdoor Recreation
  #   - Paint, Wall Treatments & Supplies
  #   - Painting, Drawing & Art Supplies
  #   - Pantry Staples
  #   - Party Supplies
  #   - Patio Furniture & Accessories
  #   - Power & Hand Tools
  #   - Replacement Parts
  #   - Safety & Security
  #   - Sewing
  #   - Skin Care
  #   - Snacks & Sweets
  #   - Sport Specific Clothing
  #   - Sports
  #   - Sports & Outdoor Play
  #   - Sports & Outdoor Recreation Accessories
  #   - Storage & Organization
  #   - Stuffed Animals & Plush Toys
  #   - Television & Video
  #   - Tools & Accessories
  #   - Toy Figures & Playsets
  #   - Vitamins, Minerals & Supplements
  #   - Wall Art
  #   - Women
  # - type: string
  #   name: category2
  #   field: item.category2
  #   scope: item
  #   encode: index
  #   values:
  #   - Accessories
  #   - Action Figures
  #   - Baby Boys
  #   - Baby Girls
  #   - Bakeware
  #   - Basic Cases
  #   - Bathroom Accessories
  #   - Bathroom Fixtures
  #   - Bedroom Furniture
  #   - Body
  #   - Camping & Hiking
  #   - Clothing
  #   - Computer Accessories & Peripherals
  #   - Computer Components
  #   - Computers & Tablets
  #   - Cooking & Baking
  #   - Cookware
  #   - Cycling
  #   - Decorations
  #   - Decorative Pillows, Inserts & Covers
  #   - Dining & Entertaining
  #   - Face
  #   - Fishing
  #   - Hair Extensions, Wigs & Accessories
  #   - Hand Tools
  #   - Handbags & Wallets
  #   - Home Décor Accents
  #   - Jewelry
  #   - Kitchen & Table Linens
  #   - Kitchen Utensils & Gadgets
  #   - Laptop Accessories
  #   - Literature & Fiction
  #   - Living Room Furniture
  #   - Men
  #   - Nail Art & Polish
  #   - OTC Medications & Treatments
  #   - Paper
  #   - Paper & Plastic
  #   - Posters & Prints
  #   - Sheets & Pillowcases
  #   - Shoes
  #   - Shooting
  #   - Small Appliances
  #   - Storage & Organization
  #   - Uniforms, Work & Safety
  #   - Watches
  #   - Window Treatments
  #   - Women
  #   - Writing & Correction Supplies
  # - type: string
  #   name: color
  #   field: item.color
  #   scope: item
  #   encode: index
  #   values:
  #   - black
  #   - blue
  #   - brown
  #   - green
  #   - grey
  #   - multicolor
  #   - pink
  #   - red
  #   - silver
  #   - white

  # - type: string
  #   name: material
  #   field: item.material
  #   scope: item
  #   encode: index
  #   values:
  #   - fabric
  #   - glass
  #   - leather
  #   - metal
  #   - paper
  #   - plastic
  #   - rubber
  #   - silicone
  #   - steel
  #   - wood
  # - type: number
  #   name: price
  #   field: item.price
  #   scope: item
  # - type: number
  #   name: ratings
  #   field: item.ratings
  #   scope: item
  # - type: number
  #   name: stars
  #   field: item.stars
  #   scope: item
  # - type: string
  #   name: template
  #   field: item.template
  #   scope: item
  #   encode: index
  #   values:
  #   - apparel
  #   - art_and_craft_supply
  #   - automotive
  #   - beauty
  #   - biss_basic
  #   - book
  #   - ce
  #   - ebooks
  #   - grocery
  #   - health_and_beauty
  #   - home
  #   - home_improvement
  #   - jewelry
  #   - kitchen
  #   - lawn_and_garden
  #   - office_product
  #   - pc
  #   - pet_products
  #   - shoes
  #   - sports
  #   - toy
  #   - wireless
  # - type: number
  #   name: weight
  #   field: item.weight
  #   scope: item
models:
  default:
    type: lambdamart
    backend:
      type: lightgbm
      iterations: 100
      learningRate: 0.1
      ndcgCutoff: 10
      maxDepth: 8
      seed: 0
      sampling: 0.8
    features:
      # - query_title_mpnet
      # - query_title_ce
      # - random
      - query_title_bm25
      - query_desc_bm25
      - query_bullets_bm25
      # - query_title_minilm6
      # - category0
      # - category1
      # - category2
      # - color
      # - material
      # - price
      # - ratings
      # - stars
      # - template
      # - weight
    weights: {}
    split: field=split:train:test
